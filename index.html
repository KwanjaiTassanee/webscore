<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <!-- Favicon -->
  <link rel="icon" href="https://dorothydalton.com/wp-content/uploads/2019/06/score-768x576.png" type="image/png">
  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mitr">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css"
    integrity="sha384-r4NyP46KrjDleawBgD5tp8Y7UzmLA05oM1iAEQ17CSuDqnUK2+k9luXQOfXJCJ4I" crossorigin="anonymous">
  <!-- Font Awesome -->
  <script src="https://kit.fontawesome.com/6a972cf3a7.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
    integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

  <style>
    body {
      font-family: "Mitr";
    }

    /* Hides the warning bar */
    .warning-bar {
      visibility: hidden;
    }
  </style>
</head>

<body>
  <iframe style="position: absolute; top:0; left:0;  height:100%; width:100%;border:0;"
    src="https://script.google.com/macros/s/AKfycbz3ygJiiQb-jsMjUv2V2PC0_-20GEAh9N-5ccPziUeg7tfiyXY0orG9DfEq13nxahBe/exec">
  <!-- <iframe
  src="https://script.google.com/macros/s/AKfycbz3ygJiiQb-jsMjUv2V2PC0_-20GEAh9N-5ccPziUeg7tfiyXY0orG9DfEq13nxahBe/exec"
  height="500"
  width="1000"
  style="border: none;">
</iframe> -->

  <div class="container">
    <br>
    <div class="row">
      <div class="col-md-8 mx-auto">
        <div class="card text-center">
          <div class="card-header">
            System Analysis and Design (Aj.Kwan) <br>การวิเคราะห์และออกแบบระบบสารสนเทศ
          </div>
          <div class="card-body">
            <!-- ## ฟอร์มค้นหา ------------------------------------------------ -->
            <form id="search-form" class="form-inline" onsubmit="handleFormSubmit(this)">
              <!-- <form id="search-form" class="form-inline" onsubmit="handleFormSubmit(this)"> -->

              <div class="form-group mb-2">
                <label for="searchtext">แจ้งคะแนน Quiz II คะแนนเต็ม 10 คะแนน</label>
              </div>
              <div class="form-group mx-sm-3 mb-2">
                <input type="text" class="form-control" id="searchtext" name="searchtext" placeholder="กรอกรหัส 6 ตัวอักษร">
              </div>
              <button type="submit" class="btn btn-primary mb-2">ค้นหา</button>
            </form>
            <!-- ## ปิดฟอร์ม ------------------------------------------------ -->
          </div>
        </div>
      </div>
    </div>

    <br>

    <div class="row">
      <div class="col-md-8 mx-auto">
        <!-- ## สร้างตาราง ------------------------------------------------ -->
        <div id="search-results" class="table-responsive">
          <!-- แสดงข้อมูลที่นี่ -->
        </div>
        <!-- ## จบตาราง ------------------------------------------------ -->
      </div>
    </div>
  </div>

  <!--## JAVASCRIPT ---------------------------------------------------- -->
  <script>
    window.addEventListener("load", preventFormSubmit, true);

            function preventFormSubmit() {
                var forms = document.querySelectorAll('form');
                for (var i = 0; i < forms.length; i++) {
                    forms[i].addEventListener('submit', function(event) {
                        event.preventDefault();
                    });
                }
            }

            // ทำการส่งค่าจากฟอร์ม
            function handleFormSubmit(formObject) {
                google.script.run.withSuccessHandler(createTable).processForm(formObject);
                document.getElementById("search-form").reset();
            }

            // สร้างตารางและข้อมูลในตาราง
            function createTable(dataArray) {
                if (dataArray && dataArray.length != 0) {
                    var result = "<table class='table table-sm table-striped table-hover' id='dtable'>" +
                                 "<thead style='white-space: nowrap'>" +
                                 "<tr>" +
                                 "<th scope='col'>Student ID</th>" +
                                 "<th scope='col'>ชื่อ-นามสกุล</th>" +
                                 "<th scope='col'>Score</th>" +
                                 "</tr>" +
                                 "</thead>";
                    for (var i = 0; i < dataArray.length; i++) {
                        result += "<tr>";
                        for (var j = 0; j < dataArray[i].length; j++) {
                            result += "<td>" + dataArray[i][j] + "</td>";
                        }
                        result += "</tr>";
                    }
                    result += "</table>";
                    document.getElementById('search-results').innerHTML = result;
                } else {
                    document.getElementById('search-results').innerHTML = "Data Not Found!!!!";
                }
            }
  </script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8" crossorigin="anonymous">
  </script>
    </iframe>
</body>

</html>
